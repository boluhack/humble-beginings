!function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n=window.jsonpFunctionUdash;window.jsonpFunctionUdash=function(r,s){for(var i,a,u=0,c=[];u<r.length;u++)a=r[u],o[a]&&c.push.apply(c,o[a]),o[a]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i]);for(n&&n(r,s);c.length;)c.shift().call(null,t)};var r={},o={0:0};return t.e=function(e,n){if(0===o[e])return n.call(null,t);if(void 0!==o[e])o[e].push(n);else{o[e]=[n];var r=document.getElementsByTagName("head")[0],s=document.createElement("script");s.type="text/javascript",s.charset="utf-8",s.async=!0,s.src=t.p+""+({1:"uheatmap",2:"uplayer"}[e]||e)+".js",r.appendChild(s)}},t.m=e,t.c=r,t.p="./dist/",t(0)}([function(e,t,n){/**
	 * 
	 * (c) Use It Better, http://useitbetter.com
	 *
	 *
	 * @preserve
	 */
function r(){var e=document.querySelector('script[src*="udash."]').getAttribute("src"),t=e.split("/").pop();return e.replace(t,"")}n.p=r(),function(e){"use strict";var t={result:[],tests:{"Element.addEventListener":function(){return"addEventListener"in e},"Date.now":function(){return"now"in e.Date},"String.trim":function(){return"trim"in e.String.prototype},JSON:function(){return"JSON"in e},localStorage:function(){return"localStorage"in e},sessionStorage:function(){return"sessionStorage"in e},"Canvas.getContext":function(){return"getContext"in e.document.createElement("canvas")}},check:function(){var e;for(e in this.tests)this.tests.hasOwnProperty(e)&&this.tests[e]()===!1&&this.result.push(e);return 0===this.result.length},getResult:function(){return this.result.join(", ")}};if(t.check()){var r=n(1),o={_uDashInitOptions:{},_inject:function(t){r._sstorage.get("uDebug")&&"undefined"==typeof r._uConsole.log&&r._uConsole.init(!0),r._sstorage.get("uHeatMapData")?("undefined"==typeof r._uConsole.log&&r._uConsole.init(!0),e.uDash=n(2),e.uDash.init.call(e.uDash,t),n.e(1,function(r){var o=n(3);e.uHeatMap=o,o.init.call(e.uDash,t)})):r._sstorage.get("uSessionHash")&&r._sstorage.get("uProjectHash")?n.e(2,function(r){var o=n(4);e.uDash=o,e.uDash.init.call(e.uDash,t)}):(e.uDash=n(2),e.uDash.init.call(e.uDash,t)),e.uDash.shared=r},_checkMessage:function(t){var n=t.data,s=t.data.params;n&&n.uDashMessage===!0&&s&&"object"==typeof s.uParams&&(r._timeouts.clear("publishTimeout"),e.removeEventListener("message",o._checkMessage),r._uParams.loadFromJSON(s.uParams),o._inject(o._uDashInitOptions))},run:function(){var t=this;e.uDash={META_ACTION:r.META_ACTION,META_SECTION:r.META_SECTION,META_ERROR:r.META_ERROR,META_SITE_IS_READY:r.META_SITE_IS_READY,init:function(n){var o;if(t._uDashInitOptions=n,r._uParams.loadFromUrl())t._inject(n);else if(n.uProjectName&&n.uPort&&n.uProjectApiPass&&(o=r._sstorage.getBackup(n.uProjectName,n.uPort,n.uProjectApiPass))&&o&&(o.inthesample&&r._lstorage.set("inthesample",o.inthesample),o.outofsample&&r._lstorage.set("outofsample",o.outofsample),o.userID&&r._lstorage.set("userID",o.userID),o.userVisit&&r._lstorage.set("userVisit",o.userVisit),o.logDumpToken&&r._sstorage.set("logDumpToken",o.logDumpToken),o.timeOffset&&r._sstorage.set("timeOffset",o.timeOffset),o.uDebug&&r._sstorage.set("uDebug",o.uDebug)),e!==e.top)try{e.addEventListener("message",t._checkMessage,!1),e.parent.postMessage({uDashMessage:!0,name:"requestUParams"},"*"),r._timeouts.set("publishTimeout",function(){t._inject(n)},150)}catch(t){return r._uConsole.log("frame access",t),e.parent.postMessage({uDashMessage:!0,name:"changeDomain",href:window.location.href},"*"),void setTimeout(e.uDash.init,500,n)}else t._inject(n)},getSetting:function(){return""},getStatus:function(){return"notready"},tearDown:function(){},saveAttribute:function(){},saveMeta:function(){},sendDump:function(){}}}};o.run()}else e.console&&e.console.log&&e.console.log("uDash: this browser is incapable of handling uDash properly. Failed support test(s) for: "+t.getResult()),e.uDash={META_ACTION:"",META_SECTION:"",META_ERROR:"",META_SITE_IS_READY:"",init:function(){},getSetting:function(){return""},getStatus:function(){return"incompatible"},tearDown:function(){},saveAttribute:function(){},saveMeta:function(){},sendDump:function(){}}}(window)},function(e,t,n){var r,o;r=[],o=function(){var e=function(e){var t={META_ACTION:"Action",META_SECTION:"Section",META_ERROR:"Error",META_SITE_IS_READY:"Site is ready",_version:"uDash JS 3.0.14",_status:["notready","setup","ready","connected","teardown"][0],_heatmapstatus:["notready","setup","ready","connected","teardown"][0],_defaults:{_assetsPath:"https://uibcdn.com/html_includes/",_apiUrl:"http://api.useitbetter.com/",_apiUrlSSL:"https://apigl.useitbetter.com/",_panelPath:"https://app.useitbetter.com/",uDumpProtocole:"https:",cdnDomain:"uibcdn.com",uDumpDomain:"l.useitbetter.com",uDumpMethod:"pushFileAppendData.php",uProjectName:"",uPort:"",uProjectApiPass:"",uForceTracking:0,uRecordInteractiveEvents:!0,uRecordFormSubmit:!0,uRecordHashChange:!0,uRecordParamsChange:!1,uRecordUrlChange:!0,uRecordPageChanges:!1,uRecordPageChangesAfterEvent:"click",uRecordCookies:!1,maskTagContentSelectors:['[udash-mask-content="1"]'],maskTagAttributeSelectors:['[udash-mask-attributes="value"]'],uIncludeHostnameInSection:!1,uCompressDump:!1,uRecordFrames:!1,uRecordPointerChange:200,uIgnoreEvents:{},uFullElementBacktrace:!1,uIgnoreClassNamesWithPrefix:!1,uPackageLimit:40,uSendTimeout:5,uShowConsoleMessages:!1,uShowEventsTraceInConsole:!0,uSample:0,uTrackingMode:"SESSIONS",uUseDefaultPanelOpener:!1,uEmptySendLimit:300,uKeepConnection:!1,uRecordAjax:!1,uCrossSiteSessionsEnabled:!0,uCrossSiteSameDomain:!0,uTriggersEnabled:!0,uAllowTriggersInNotRecordedSessions:!0,uDotSize:28,uHeatMapOpacity:190,uHeatMapGradient:{.05:"#35267b",.1:"#3f1e7b",.15:"#49087f",.2:"#5c0872",.25:"#78085d",.3:"#91084c",.35:"#a7083c",.4:"#b8082f",.45:"#ca0822",.5:"#d61119",.55:"#d73319",.6:"#d75919",.65:"#d78219",.7:"#d7a919",.75:"#d7ba1a",.8:"#d7cc1c",.85:"#d7d446",.9:"#d7d479",.95:"#d7d4ae",1:"#d7d4e5"},uHeatMapStyles:{},uAjaxCacheFlag:"cacheFromUser",uSkipTimeThreshold:7,uWrapperSelector:"",onReady:function(){},onConnected:function(){},onTeardown:function(){},onDumpSend:function(){}},_failedRequestRetry:2,_failedRequests:0,_failedSetups:0,_isIE9:e.navigator.userAgent.indexOf("MSIE 9")>-1,_isIE9Mobile:e.navigator.userAgent.indexOf("MSIE 9")>1&&e.navigator.userAgent.indexOf("Mobile")>1,_isTouchSupported:"ontouchstart"in e,_recordsSeparator:"\n",_lstorage:{},_sstorage:{},_winEventListenerCapture:{},_docEventListenerCapture:{},_htmlEventListenerCapture:{},_UStorage:function(){var n=function(e){this.storageObject=e};return n.prototype={set:function(e,t){var n,r;if("object"!=typeof e)return e.match(/^uDash\./)&&(e=e.replace("uDash.","")),this.storageObject.setItem("uDash."+e,t);n=e;for(r in n)n.hasOwnProperty(r)&&this.set(r,n[r])},get:function(e){return this.storageObject.getItem("uDash."+e)},remove:function(e){return this.storageObject.removeItem("uDash."+e)},makeBackup:function(n,r,o){if(!window.uDash._globalSettings.uCrossSiteSessionsEnabled)return void t._uConsole.log("uRecorder: cross-site/domain tracking disabled");try{var s={},i=[],a="",u="",c="",l="@#@";if(s.userID=e.localStorage.getItem("uDash.userID"),!s.userID)return;s.userVisit=e.localStorage.getItem("uDash.userVisit"),window.uDash._globalSettings.uCrossSiteSameDomain||(s.inthesample=e.localStorage.getItem("uDash.inthesample"),s.outofsample=e.localStorage.getItem("uDash.outofsample")),e.udashSessionToken&&(s.logDumpToken=e.udashSessionToken),s.timeOffset=e.sessionStorage.getItem("uDash.timeOffset");var d=e.sessionStorage.getItem("uDash.uDebug");d&&(s.uDebug=d),i=e.name.split("%p%"+o+"%p%"),i.length>1?(a=i[0]+"%p%"+o+"%p%",u=i[1].substr(i[1].indexOf("%e%"),i[1].length-1),c=a+l+u):c+="%s%"+[n,r,o,l].join("%p%")+"%e%",e.name=c.replace(l,JSON.stringify(s))}catch(e){t._uConsole.log("uRecorder: backup failed with error:",e)}},getBackup:function(n,r,o){var s,i,a,u=e.name.match(/\%s\%.+\%e\%/),c=!1;try{if(!u){var l=t._readCookie("uDashBackup");l&&(u=unescape(l).match(/\%s\%.+\%e\%/)),u?c=!0:u=[]}for(a=0;a<u.length;a++)if(s=u[a].split("%s%")[1].split("%e%")[0].split("%p%"),4===s.length&&s[0]===n)return i=JSON.parse(s[3]),!!(!c||i["uDash.currentUrl"]&&t._domainChanged(e.location.href,i["uDash.currentUrl"]))&&i}catch(e){return"undefined"!=typeof uDash&&uDash.saveMeta&&uDash.saveMeta("recording alert","could not read backup"),setTimeout(function(){"undefined"!=typeof uDash&&uDash.saveMeta&&uDash.saveMeta("recording alert","could not read backup")},3e3),i={},!1}return!1},clear:function(e){e=e||{};var t;for(t in this.storageObject)t.match(/^uDash\./)&&(e.except&&e.except.indexOf(t.replace("uDash.",""))!==-1||this.storageObject.removeItem(t))}},n}(),_UEventListenerCapture:function(){var e={registered:[],add:function(e,t,n,r){this.registered.push({target:e,name:t,handler:n,useCapture:r})},remove:function(e,t,n){var r;for(r=0;r<this.registered.length;r++)if(this.registered[r].target===e&&this.registered[r].name===t&&this.registered[r].handler===n)return this.registered.splice(r,1),r;return-1}},t=function(t){this.target=t,this.augmentTarget="undefined"!=typeof t.prototype&&"undefined"!=typeof t.prototype.addEventListener?t.prototype:t,function(t,n){t.addEventListener=function(t,r,o,s){return s||e.add(this,t,r,o),n.call(this,t,r,o)}}(this.augmentTarget,this.augmentTarget.addEventListener),function(t,n){t.removeEventListener=function(t,r,o){return o||e.remove(this,t,r),n.call(this,t,r)}}(this.augmentTarget,this.augmentTarget.removeEventListener)};return t.prototype={addAll:function(t){var n;for(n=0;n<e.registered.length;n++)("object"==typeof this.target&&e.registered[n].target===this.target||"function"==typeof this.target&&e.registered[n].target instanceof this.target)&&this.target.addEventListener(e.registered[n].name,e.registered[n].handler,e.registered[n].useCapture,!0)},removeAll:function(){var t;for(t=0;t<e.registered.length;t++)("object"==typeof this.target&&e.registered[t].target===this.target||"function"==typeof this.target&&e.registered[t].target instanceof this.target)&&this.target.removeEventListener(e.registered[t].name,e.registered[t].handler,!0)}},t}(),_apiManager:{apiHost:"",apiHostSSL:"",apiProjectAuthKey:"",apiAccountAuthKey:"",projectHash:"",getApiUrl:function(){var n="https:"===e.location.protocol,r=t._sstorage.get("uApiUrl");return r?r:n?this.apiHostSSL||t._defaults._apiUrlSSL:this.apiHost||t._defaults._apiUrl},cache:{data:{},createIndex:function(){return JSON.stringify(Array.prototype.slice.call(arguments))},storeObject:function(){var e=Array.prototype.slice.call(arguments),t=e.shift(),n=this.createIndex.apply(this,e);this.data[n]=t},getObject:function(){var e=this.createIndex.apply(this,Array.prototype.slice.call(arguments));return!!this.data.hasOwnProperty(e)&&this.data[e]}},send:function(e){var n,r=this,o=e.data||{};return"string"!=typeof e.method&&t._uConsole.error("API: Specify api call method"),this.apiAccountAuthKey&&[this.ACCOUNT_PROJECT_LOGIN,this.ACCOUNT_PROJECT_LIST].indexOf(e.method)>-1?o.apiAccountAuthKey=this.apiAccountAuthKey:this.apiProjectAuthKey&&e.method!==this.ACCOUNT_LOGIN&&(o.apiAuthKey=this.apiProjectAuthKey),o.getRequest=1,n=this.cache.getObject(e,o),e.cache&&e.cache===!1||!n?t._ajax({url:r.getApiUrl()+e.method,method:"POST",data:o,success:function(t){try{t=JSON.parse(t),r.cache.storeObject(t,e,o)}catch(e){t={}}return e.success(t)}}):n?e.success(n):void 0}},_propertyNames:{_map:{kC:"keyCode",cX:"clientX",cY:"clientY",pX:"pageX",pY:"pageY",sX:"screenX",sY:"screenY",id:"identifier",t:"touches",tT:"targetTouches",cT:"changedTouches"},_iterator:function(e,t){var n,r,o,s;if(Array.isArray(e))for(s=[],r=0;r<e.length;r++)"object"==typeof e[r]?s[r]=this._iterator(e[r],t):s[r]=e[r];else{s={};for(n in e)e.hasOwnProperty(n)&&(o=t(n),"object"==typeof e[n]?s[o]=this._iterator(e[n],t):s[o]=e[n])}return s},getShortName:function(e){var t;for(t in this._map)if(this._map.hasOwnProperty(t)&&this._map[t]===e)return t;return e},getLongName:function(e){return this._map[e]||e},shorten:function(e){return this._iterator(e,t._bindShim(this.getShortName,this))},expand:function(e){return this._iterator(e,t._bindShim(this.getLongName,this))}},_bindShim:function(){var e=Array.prototype.slice.call(arguments),t=e.shift(),n=e.shift();return function(){return t.apply(n,arguments)}},_selectorMatch:function(t,n,r){r||(r=e.document);var o,s=r.querySelectorAll(t);for(o=0;o<s.length;o++)if(s[o]===n)return!0;return!1},_extend:function(){var e,n,r,o=Array.prototype.slice.call(arguments),s=o.shift();for(r=0;r<o.length;r++){e=o[r];for(n in e)if(e.hasOwnProperty(n))if("object"!=typeof e[n]||Array.isArray(e[n]))try{s[n]=e[n]}catch(e){}else s.hasOwnProperty(n)?s[n]=t._extend(s[n],e[n]):s[n]=t._extend({},e[n])}return s},getStatus:function(){return this._status},_attachEventHandlers:function(t,n){var r,o,s;for(r in t)n.uIgnoreEvents[r]||t.hasOwnProperty(r)&&(r.match(/^doc\_/)?(o=e.document,s=r.replace("doc_","")):r.match(/^win\_/)?(o=e,s=r.replace("win_","")):o=null,o&&o.addEventListener(s,t[r],!0))},_detachEventHandlers:function(t){var n,r,o;for(n in t)t.hasOwnProperty(n)&&(n.match(/^doc\_/)?(r=e.document,o=n.replace("doc_","")):n.match(/^win\_/)?(r=e,o=n.replace("win_","")):r=null,r&&r.removeEventListener(o,t[n]))},_getDocumentSize:function(){return{width:e.document.documentElement.scrollWidth,height:e.document.documentElement.scrollHeight}},_getWindowSize:function(){return{width:e.document.documentElement.clientWidth,height:e.document.documentElement.clientHeight}},_getScroll:function(){var t=e.document.documentElement,n=e.document.body;return{x:t&&t.scrollLeft||n&&n.scrollLeft||0,y:t&&t.scrollTop||n&&n.scrollTop||0}},_getDocumentScale:function(){var t=void 0,n=e.innerWidth;return e.orientation?(n=screen.width,"portrait"===e.orientation?screen.width>screen.height&&(n=screen.height):screen.width<screen.height&&(n=screen.height),t=n/e.innerWidth):t=1,t},_uConsole:{init:function(n){e.console&&n?t._uConsole=e.console:t._uConsole={log:function(){},error:function(){},warn:function(){}}}},_timeouts:{current:{},set:function(t,n,r){var o=this,s=t,i=0;if("number"==typeof this.current[t]){do s=t+"."+i,i+=1;while("number"==typeof this.current[s]);t=s}this.current[t]=e.setTimeout(function(){o.clear(t),n()},r)},clear:function(t){"number"==typeof this.current[t]&&(e.clearTimeout(this.current[t]),delete this.current[t])},clearAll:function(){var e;for(e in this.current)this.current.hasOwnProperty(e)&&this.clear(e)}},_loadCss:function(t,n){var r,o=e.document.querySelector("body");e.document.createStyleSheet?(r=e.document.createElement("style"),this._ajax({method:"GET",url:n+"getCrossdomain.php?uStylesheetFile="+t,success:function(t){r.appendChild(e.document.createTextNode(t)),o.appendChild(r)}})):(r=e.document.createElement("link"),r.setAttribute("rel","stylesheet"),r.setAttribute("href",n+t),o.appendChild(r))},_wrapFinder:{_wrapper:null,_levelLimit:5,_levelRating:[-3,0,-1,-1,-2,-2,-3,-3],_candidates:[],_compareWidth:0,_words:[/wrap/i,/contain/i,/conten/i],_getCompareWidth:function(){var t=e.getComputedStyle(e.document.documentElement),n=e.getComputedStyle(e.document.body);return"hidden"===t.overflow||"hidden"===n.overflow||"hidden"===t.overflowX||"hidden"===n.overflowX?e.document.body.clientWidth:e.document.body.scrollWidth},find:function(){return this._wrapper||(this._compareWidth=this._getCompareWidth(),this._buildCandidates(e.document.documentElement,0),this._candidates.sort(function(e,t){return e.rating>t.rating?-1:e.rating<t.rating?1:0}),this._wrapper=this._candidates[0].element),this._wrapper},_rateElement:function(e,n){var r,o=0,s=t._getWindowSize(),i=Math.ceil(e.getBoundingClientRect().left+t._getScroll().x);for((e.clientWidth<this._compareWidth&&e.clientWidth>this._compareWidth/2||e.clientWidth>s.width)&&(o+=10),i!==Math.ceil((this._compareWidth-e.clientWidth)/2)&&i!==Math.ceil((this._compareWidth-e.clientWidth)/2)-1||(o+=15),r=0;r<this._words.length;r++)e.className&&e.className.match&&e.className.match(this._words[r])&&(o+=5),e.getAttribute("id")&&e.getAttribute("id").match(this._words[r])&&(o+=7);return o+=this._levelRating[n]},_buildCandidates:function(e,t){var n=e.children,r=0;if(t<this._levelLimit&&n.length>0)for(r=0;r<n.length;r++)1===n[r].nodeType&&(this._candidates.push({element:n[r],rating:this._rateElement(n[r],t)}),this._buildCandidates(n[r],t+1))},setWrapper:function(e){this._wrapper=e},getWrapperOffset:function(){return Math.floor(this.find().getBoundingClientRect().left+t._getScroll().x)}},_uParams:{_keysToPreserve:["apiAuthKey"],loadFromUrl:function(){var n,r,o="",s={},i={};if(e.location.search.indexOf("uParams")>-1?n=e.location.search:e.location.hash.indexOf("uParams")>-1&&(n=e.location.hash),n){for(t._sstorage.clear({except:this._keysToPreserve}),o=decodeURIComponent(decodeURI(n)).split("uParams=")[1].split("&")[0],s=o.split("||"),r=0;r<s.length;r++)i=s[r].split("@@"),t._sstorage.set(i[0],i[1]);return!0}return!1},stripFromUrl:function(e){if(e=e.replace(/uParams=[a-zA-Z0-9@%\/]+/,""),e.indexOf("?#")>-1&&(e=e.replace("?#","#")),e.indexOf("?")===e.length-1&&(e=e.slice(0,e.length-1)),e!==e){var t=e.substr(-1);"?"!==t&&"#"!==t||(e=e.substr(0,e.length-1))}return e},loadFromJSON:function(e){if(!e.toString||"[object Object]"!==e.toString())try{e=JSON.parse(e)}catch(t){e={}}t._sstorage.clear({except:this._keysToPreserve}),t._sstorage.set(e)},stringFromObject:function(e){var t,n=[];for(t in e)n.push(t+"@@"+e[t]);return n.join("||")}},_getMetaSectionAutosaveName:function(n){var r=n.uIncludeHostnameInSection?e.location.hostname+e.location.pathname:e.location.pathname,o=e.location.search,s=e.location.hash,i="";if("/"===r[0]&&(r=r.substr(1)),""===r&&(r="Home"),n.uRecordUrlChange&&(i=r),n.uRecordParamsChange&&o&&(i=r+o),n.uRecordHashChange&&(i+=s),i){var a=t._prepareUrl(decodeURIComponent(i));i=a}n.uRecordExecutionFlow||(i=i.replace(/e+[0-9]+s+[0-9]+/,""));var u=i.split("uParams");return u[1]&&(i=u[0],u[1].indexOf("&")>-1&&(i+=u[1].substr(u[1].indexOf("&")+1,u[1].length))),i?i:""},_prepareUrl:function(e){return e.indexOf("#")===e.length-1&&(e=e.slice(0,e.length-1)),e},_encodePOST:function(e){var t,n,r=[];for(t in e)e.hasOwnProperty(t)&&(n=(e[t]||"").toString(),n=encodeURIComponent(n).replace("%20","+"),t=encodeURIComponent(t).replace("%20","+"),r.push(t+"="+n));return r.join("&")},_ajax:function(n){var r,o=n.success||function(){},s=n.error||function(){},i=n.data||{},a=n.url,u=n.method||"POST",c="",l=function(){"teardown"!==t.getStatus()&&(t._failedRequests<t._failedRequestRetry?(t._failedRequests++,t._ajax(n)):s(r))};"POST"===u&&(c=t._encodePOST(i)),"XDomainRequest"in e?(r=new XDomainRequest,r.onprogress=function(){},r.onload=function(){o(r.responseText)},r.onerror=function(){l()}):"XMLHttpRequest"in e?(r=new XMLHttpRequest,r.onreadystatechange=function(){4===r.readyState&&(200===r.status?o(r.responseText):l())}):t._uConsole.error("uDash: no asynchronous transport method available"),r._uibRequest=!0;try{r.open(u,a),"POST"===u?(r instanceof XMLHttpRequest&&r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send(c)):r.send()}catch(e){s(r)}return r},__getElementByPath:function(e){var t=document.getElementsByTagName("body")[0],n=t;if(e.indexOf("#")>-1){var r=e.split("#")[1];r.indexOf("/")>-1&&(r=r.split("/")[0],e=e.substr(e.indexOf("/")+1,e.length)),r.indexOf(".")>-1&&(r=r.split(".")[0]),t=window.document.getElementById(r)}if(e=e.split("/"),e.length>0)for(var o=0;o<e.length;o++){var s=e[o].split("[");if(null==s[1]?s[1]=0:s[1]=1*s[1].split("]")[0]-1,s[0].indexOf(".")>0){var i=s[0].split(".");s[0]=i.shift(),s.push(i.join("."))}t&&(n=t,t=t.children[s[1]])}return t},_getDomain:function(){if(t.domain)return t.domain;for(var e=0,n=document.domain,r=n.split("."),o="_gd"+(new Date).getTime();e<r.length-1&&document.cookie.indexOf(o+"="+o)==-1;)n=r.slice(-1-++e).join("."),document.cookie=o+"="+o+";domain="+n+";";return document.cookie=o+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain="+n+";",t.domain=n,n},_domainChanged:function(n,r){var o=n.split("/");if(r||(r=t._sstorage.get("currentUrl")),r){var s=r.split("/");if(t._sstorage.set("currentUrl",e.location.href),o[2]!=s[2]||o[0]!=s[0])return!0}return!1},_setCookie:function(n,r,o){o||(o=new Date,o.setTime(o.getTime()+15552e7)),"string"!=typeof r&&(r=JSON.stringify(r)),e.document.cookie=n+"="+escape(r)+"; domain="+t._getDomain()+"; path=/; expires="+o.toGMTString()+";"},_readCookie:function(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return unescape(o.substring(t.length,o.length))}return null}};return t._lstorage=new t._UStorage(e.localStorage),t._sstorage=new t._UStorage(e.sessionStorage),t}(window);return e}.apply(t,r),!(void 0!==o&&(e.exports=o))},function(e,t,n){var r,o;r=[n(1)],o=function(e){var t=function(t){var n,r=e._extend({},e._defaults),o={x:0,y:0},s={width:0,height:0},i=!1,a=!1,u=!1,c={},l={_eventHandlers:{doc_click:function(t){var n=e._getScroll();S(t.clientX+n.x,t.clientY+n.y),R(t.type,t.timeStamp,t.clientX+n.x,t.clientY+n.y,t.target)},doc_mouseover:function(t){var n=e._getScroll();S(t.clientX+n.x,t.clientY+n.y),R(t.type,t.timeStamp,t.clientX+n.x,t.clientY+n.y,t.target)},doc_mousedown:function(t){var n=e._getScroll();S(t.clientX+n.x,t.clientY+n.y),R(t.type,t.timeStamp,t.clientX+n.x,t.clientY+n.y,t.target),D.send()},doc_mouseup:function(t){var n=e._getScroll();S(t.clientX+n.x,t.clientY+n.y),R(t.type,t.timeStamp,t.clientX+n.x,t.clientY+n.y,t.target)},doc_touchstart:function(t){var n=e._getScroll();S(t.changedTouches[0].clientX+n.x,t.changedTouches[0].clientY+n.y),R(t.type,t.timeStamp,t.changedTouches[0].clientX+n.x,t.changedTouches[0].clientY+n.y,t.changedTouches[0].target,e._propertyNames.shorten(C(t)))},doc_touchend:function(t){var n=e._getScroll();S(t.changedTouches[0].clientX+n.x,t.changedTouches[0].clientY+n.y),R(t.type,t.timeStamp,t.changedTouches[0].clientX+n.x,t.changedTouches[0].clientY+n.y,t.changedTouches[0].target,e._propertyNames.shorten(C(t)))},doc_touchcancel:function(t){var n=e._getScroll();S(t.changedTouches[0].clientX+n.x,t.changedTouches[0].clientY+n.y),R(t.type,t.timeStamp,t.changedTouches[0].clientX+n.x,t.changedTouches[0].clientY+n.y,t.changedTouches[0].target,e._propertyNames.shorten(C(t)))},doc_keydown:function(t){var n=t.target.getBoundingClientRect(),r=e._getScroll();u||R(t.type,t.timeStamp,Math.ceil(n.left+t.target.offsetWidth/2+r.x),Math.ceil(n.top+t.target.offsetHeight/2+r.y),t.target,{kC:t.keyCode})},doc_keyup:function(t){var n=t.target.getBoundingClientRect(),r=e._getScroll();u||R(t.type,t.timeStamp,Math.ceil(n.left+t.target.offsetWidth/2+r.x),Math.ceil(n.top+t.target.offsetHeight/2+r.y),t.target,{kC:t.keyCode})},doc_submit:function(t){r.uRecordFormSubmit&&x(e.META_ACTION,"Submitted form: "+M(t.target),!1)},doc_focus:function(n){var r,o;n.target===t||n.target===t.document||n.target===t.document.body?i||a||(x("Window Focus",null,!1),a=!0):(!n.target.tagName||"textarea"!==n.target.tagName.toLowerCase()&&"input"!==n.target.tagName.toLowerCase()||(u=!0),r=n.target.getBoundingClientRect(),o=e._getScroll(),R(n.type,n.timeStamp,Math.ceil(r.left+n.target.offsetWidth/2+o.x),Math.ceil(r.top+n.target.offsetHeight/2+o.y),n.target))},doc_blur:function(e){e.target!==t&&e.target!==t.document&&e.target!==t.document.body||!a?e.target.tagName&&("input"===e.target.tagName.toLowerCase()&&["text","email","number","url","tel"].indexOf(e.target.type)>-1||"textarea"===e.target.tagName.toLowerCase())&&(u=!1):(i=!1,x("Window Unfocus",null,!1),a=!1)},doc_change:function(t){var n=t.target.getBoundingClientRect(),r=e._getScroll(),o={},s=t.target.getAttribute("udash-mask-offset")||0,i=t.target.getAttribute("udash-mask-value")||(s>0?"true":"auto"),a=t.target.getAttribute("udash-mask-label")||(s>0?"true":"auto"),u=t.target.getAttribute("udash-ignore");"true"!=u&&(t.target.checked?(o.chk=1,"auto"==i&&(i="false"),"on"!==t.target.value&&(o.val=t.target.value)):(o.val=t.target.value,"select"===t.target.tagName.toLowerCase()?(o.label=t.target.options[t.target.selectedIndex].innerHTML,""==o.val&&o.val!=t.target.options[t.target.selectedIndex].value&&(o.val=t.target.options[t.target.selectedIndex].value),"true"==a&&(o.label=f(o.label,s)),"auto"==i&&(i="false")):"auto"==i&&(i="true")),"false"!=i&&(o.val=f(o.val,s)),t.target.name&&(o.name=t.target.name),t.target.type&&(o.type=t.target.type),R(t.type,t.timeStamp,Math.ceil(n.left+t.target.offsetWidth/2+r.x),Math.ceil(n.top+t.target.offsetHeight/2+r.y),t.target,o))},win_unload:function(){e._sstorage.makeBackup(r.uProjectName,r.uPort,r.uProjectApiPass),D.send()},_manualsend:function(){D.send()},_hashchange:function(n){var r=T(),o=e._getScroll();y(),A("e",P(n.timeStamp),r.x+o.x,r.y+o.y,"_uJS","HashChange",t.location.hash)}},_receiveFrameEvent:function(t){if(t.data){var n=t.data.split("|"),r=e._getScroll();if("e"==n[0]){for(var o=document.getElementsByTagName("IFRAME"),s=null,i=0;i<o.length;i++)if(o[i].contentWindow==t.source){s=o[i];break}n[4]=M(s)+"/"+n[4]}3==n.length?A(n[0],n[1],n[2]):s&&(n[2]*=1,n[3]*=1,4==n.length?A(n[0],P(t.timeStamp),s.offsetLeft+n[2]+r.x,s.offsetTop+n[3]+r.y):5==n.length?A(n[0],P(t.timeStamp),s.offsetLeft+n[2]+r.x,s.offsetTop+n[3]+r.y,n[4]):6==n.length?A(n[0],P(t.timeStamp),s.offsetLeft+n[2]+r.x,s.offsetTop+n[3]+r.y,n[4],n[5]):7==n.length&&A(n[0],P(t.timeStamp),s.offsetLeft+n[2]+r.x,s.offsetTop+n[3]+r.y,n[4],n[5],n[6]))}},IntervaledHandler:function(){var t=function(e){this.timeLimit=parseInt(e.time,10)||100,this.lastTimestamp=0,this.grabTimeoutName=e.name+"Grab",this.save=e.save};return t.prototype={handle:function(t,n,r){r=!!r,n=n||{scroll:e._getScroll()};var o=Date.now(),s=this;o-this.lastTimestamp>this.timeLimit&&(this.lastTimestamp=o,this.save(t,n)),r||(e._timeouts.clear(this.grabTimeoutName),e._timeouts.set(this.grabTimeoutName,function(){s.handle(t,n,!0)},this.timeLimit+20))}},t}(),attach:function(n){var r,o,s,i;r=new this.IntervaledHandler({name:"scroll",time:300,save:function(e,t){var n=t.scroll,r=T();a||(x("Window Focus",null,!1),a=!0),A("e",P(e.timeStamp),r.x+n.x,r.y+n.y,"_uJS","Scroll",n.x,n.y)}}),s=new this.IntervaledHandler({name:"pointer",time:n.uRecordPointerChange,save:function(e,t){var n=t.scroll;A("p",P(e.timeStamp),e.clientX+n.x,e.clientY+n.y)}}),o=new this.IntervaledHandler({name:"resize",time:800,save:function(){w()}}),i=new this.IntervaledHandler({name:"touchmove",time:n.uRecordPointerChange,save:function(t,n){var r=n.scroll;R(t.type,t.timeStamp,t.changedTouches[0].clientX+r.x,t.changedTouches[0].clientY+r.y,t.changedTouches[0].target,e._propertyNames.shorten(C(t)))}}),this._eventHandlers.win_scroll=this._eventHandlers.win_scroll||e._bindShim(r.handle,r),this._eventHandlers.win_resize=this._eventHandlers.win_resize||e._bindShim(o.handle,o),this._eventHandlers.doc_mousemove=this._eventHandlers.doc_mousemove||function(t){var r=e._getScroll();S(t.clientX+r.x,t.clientY+r.y),n.uRecordPointerChange!==!1&&s.handle(t,{scroll:r})},this._eventHandlers.doc_touchmove=this._eventHandlers.doc_touchmove||function(t){var r=e._getScroll();S(t.changedTouches[0].clientX+r.x,t.changedTouches[0].clientY+r.y),n.uRecordPointerChange!==!1&&i.handle(t,{scroll:r})},e._attachEventHandlers(this._eventHandlers,n),n.uRecordFrames&&t.addEventListener("message",this._eventHandlers._receiveFrameEvent,!1),n.uRecordHashChange&&t.addEventListener("hashchange",this._eventHandlers._hashchange),n.hasOwnProperty("uSendHook")&&(1===n.uSendHook.nodeType?n.uSendHook.addEventListener("click",this._eventHandlers._manualsend,!1):"string"==typeof n.uSendHook&&1===t.document.querySelector(n.uSendHook).nodeType&&t.document.querySelector(n.uSendHook).addEventListener("click",this._eventHandlers._manualsend,!1))},detach:function(n){e._detachEventHandlers(this._eventHandlers),n.uRecordHashChange&&t.removeEventListener("hashchange",this._eventHandlers._hashchange),n.hasOwnProperty("uSendHook")&&(1===n.uSendHook.nodeType?n.uSendHook.removeEventListener("click",this._eventHandlers._manualsend):"string"==typeof n.uSendHook&&1===t.document.querySelector(n.uSendHook).nodeType&&t.document.querySelector(n.uSendHook).removeEventListener("click",this._eventHandlers._manualsend))}},d=function(n){if("undefined"==typeof e._uConsole.log&&e._uConsole.init(n.hasOwnProperty("uShowConsoleMessages")?n.uShowConsoleMessages:e._defaults.uShowConsoleMessages),!n.uProjectName||!n.uPort||!n.uProjectApiPass)return e._uConsole.error("uRecorder: Please provide correct uProjectName, uPort and uProjectApiPass"),!1;if(e._sstorage.get("uDebug")||window.location.href.indexOf("uDebug@@on")>0||window.location.href.indexOf("preview@@on")>0){if(e._sstorage.set("uDebug",!0),r.uDebug=!0,"undefined"==typeof t.uResponses){for(var o=document.getElementsByTagName("script"),s=!1,i=o.length;i--;)if(o[i].src.indexOf("uResponses")>0){s=!0;break}if(!s){var a=document.createElement("script");a.type="text/javascript",a.src="https://"+r.cdnDomain+"/sdk/"+n.uPort+"/uResponses.min.js",t.document.getElementsByTagName("head")[0].appendChild(a)}}}else if(r.uAllowTriggersInNotRecordedSessions||n.uAllowTriggersInNotRecordedSessions||e._sstorage.get("uHeatMapData"));else if(r.uForceTracking=n.uForceTracking,e._sstorage.get("sessionLocked")&&r.uForceTracking!==!0)return e._uConsole.error("uRecorder: Recording locked in this session, reason: "+e._sstorage.get("sessionLocked")),!1;"notready"===e._status?(e._status="setup",e._uConsole.log('uRecorder: Welcome to uRecorder! Your version is "'+e._version+'". Enjoy developing!'),g(n)):e._uConsole.log("uRecorder: Already initalized, ignoring init call")},g=function(o){if(!(t.location.href.indexOf("pomoc")>-1&&(t.location.href.indexOf("salony")>-1||t.location.href.indexOf("mapa")>-1))){var i=e._sstorage.get("uPort")||null;i?o.uPort!=i&&e._sstorage.clear({}):e._sstorage.set("uPort",o.uPort),t.uDash._globalSettings=r,r=e._extend(r,o);var a=!1;if(r.uTriggersEnabled&&"false"!==e._sstorage.get("uTriggersEnabled"))if(_setupTriggers(),"loading"==e._sstorage.get("triggers")){if(e._failedSetups++,e._failedSetups<200)return void setTimeout(g,150,o)}else a=!0;else e._sstorage.set("triggers","{}");if(!t.document.querySelector("body"))return void setTimeout(g,100,o);var u,c=new Date,d=e._getDocumentSize();if(s=d,D._dumpUrl=r.uDumpProtocole+"//"+("_noport"===r.uPort?"":r.uPort+".")+r.uDumpDomain+"/"+r.uDumpMethod,D._emptySendLimit=r.uEmptySendLimit,D._keepConnection=r.uKeepConnection,r.uWrapperSelector&&(u=t.document.querySelector(r.uWrapperSelector))&&1===u.nodeType?e._wrapFinder.setWrapper(u):e._wrapFinder.find(),t.udashSessionToken=e._sstorage.get("logDumpToken")||"",e._sstorage.get("timeOffset")&&""!==t.udashSessionToken)D._locationChange(),e._domainChanged(t.location.href)&&setTimeout(L,500),A("e",P(),0,0,"_uJS","LocationChange",t.location.href),x("URL",t.location.href),v(),y(),w(),D._wasVisitSent=!0,D.send();else{var p=Date.now();"object"==typeof p?p=p.getTime():"number"!=typeof p&&(p=(new Date).getTime()),e._sstorage.set("timeOffset",p),e._lstorage.get("userID")&&e._lstorage.get("userVisit")?e._lstorage.set("userVisit",parseInt(e._lstorage.get("userVisit"),10)+1):E(),A("h","o",r.uPort,r.uProjectName,r.uProjectApiPass),I("fsc",[["R",(t.screen.width||"unknown")+"x"+(t.screen.height||"unknkown")].join("="),["L",(t.navigator.language||t.navigator.userLanguage||"").toLowerCase().substr(0,2)||"unknown"].join("=")].join("&")),I("language",t.navigator.language||t.navigator.userLanguage||"unknown"),I("screenWidth",t.screen.width||"unknown"),I("screenHeight",t.screen.height||"unknown"),I("userAgentString",t.navigator.userAgent||"unknown"),I("userID",e._lstorage.get("userID")),I("userVisit",e._lstorage.get("userVisit")),e._lstorage.get("firstVisit")&&I("firstVisit",e._lstorage.get("firstVisit")),I("version",e._version),I("timezoneOffset",c.getTimezoneOffset()),I("referrer",t.document.referrer||"none"),I("entryUrl",e._prepareUrl(t.location.href.split("uParams")[0])),"ontouchstart"in t.document?I("interface","touch"):I("interface","mouse"),A("e",P(),0,0,"_uJS","LocationChange",t.location.href),x("URL",t.location.href),setTimeout(L,500),v(),y(),w(),D._wasVisitSent=!1,e._sstorage.set("currentUrl",t.location.href)}if(a||x("alert","Triggers loading failed"),l.attach(r),r.uRecordPageChanges)try{n=new MutationObserver(function(e){e.forEach(function(e){var t=_(r.maskTagContentSelectors);_(r.maskTagAttributeSelectors);if((!e.target||!e.target.closest("#uConsole"))&&e.type)if("childList"===e.type){if(e.removedNodes.length>0){var n=e.target.innerHTML.trim();n=m(n,t),k("mutate",e.target,{type:"replaceChildren",innerHTML:n})}else if(e.addedNodes.length>0)for(var o=0;o<e.addedNodes.length;o++){var s=e.addedNodes[o];!s.outerHTML&&s.parentElement&&(s=s.parentElement);var n=s.outerHTML.trim();if(n=m(n,t),s.parentElement){var i=Array.prototype.indexOf.call(s.parentElement.children,s);k("mutate",s.parentElement,{
type:"addChild",outerHTML:n,index:i})}}}else if("attributes"==e.type){var a=e.target.attributes[e.attributeName],u="";a&&(u=a.value),k("mutate",e.target,{type:e.type,attributeName:e.attributeName,attributeValue:u})}else if("characterData"==e.type){var n=e.target.parentNode.outerHTML,c=document.createElement("template");c.innerHTML=m(n,t);var l=c.content.firstChild.innerText.trim();c=null,k("mutate",e.target.parentNode,{type:e.type,innerText:l})}})}.bind(this)),n.observe(document.documentElement,{attributes:!0,characterData:!0,childList:!0,subtree:!0});n.takeRecords()}catch(e){}D._setSendTimeout(),b(),e._status="ready",r.hasOwnProperty("onReady")&&"function"==typeof r.onReady&&r.onReady.call(t.uDash),e._sstorage.get("sessionLocked")&&(r.uForceTracking!==!0?e._status="notready":t.sessionStorage.removeItem("uDash.sessionLocked")),"ready"===e._status&&(D._isConnected()?h():D._connect())}},h=function(){e._status="connected",r.hasOwnProperty("onConnected")&&"function"==typeof r.onConnected&&r.onConnected.call(t.uDash),r.hasOwnProperty("onDumpSend")&&"function"==typeof r.onDumpSend&&(D._onSend=r.onDumpSend),e._sstorage.makeBackup(r.uProjectName,r.uPort,r.uProjectApiPass)},p=function(){if(e._sstorage.get("uDebug"))return void e._uConsole.log("uRecorder: still running in uDebug mode");if(r.uAllowTriggersInNotRecordedSessions)return void e._uConsole.log("uRecorder: still running with triggers");if(e._sstorage.get("uHeatMapData"))return void e._uConsole.log("uRecorder: still running in uHeatMap mode");var n=e.getStatus();"teardown"!==n&&"notready"!==n&&(e._status="teardown",D._disconnect(),l.detach(r),e._timeouts.clearAll(),"function"==typeof XMLHttpRequest.prototype._oldOpen&&(XMLHttpRequest.prototype.open=XMLHttpRequest.prototype._oldOpen),e._sstorage.clear({except:["sessionLocked"]}),S(-1e3,-1e3),e._status="notready",r.hasOwnProperty("onTeardown")&&"function"==typeof r.onTeardown&&r.onTeardown.call(t.uDash),e._uConsole.log("uRecorder: uRecorder torn down"))},_=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],o=r.substr(0,1);"."===o?(r=r.split(" ")[0].split("#")[0].substr(1).split(".").join(" "),r='class="'+r+'"'):"["===o?r=r.split("]")[0].substr(1):"#"===o&&(r=r.split(".")[0].split(" ")[0],r='id="'+r.substr(1)+'"'),r="*"+r+"*",t.push(r)}return 0==t.length&&t.push(""),t},m=function(e,t){for(var n=function(e,t){var n=new RegExp("(<"+t+"\\b[^>]*>)([^<>]*)(</\\b[^>]*>)","g");return e=e.replace(n,function(e,t,n,r){return n=n.replace(/[a-zęóąśłżźćń]/g,"x"),n=n.replace(/[A-ZĘÓĄŚŁŻŹĆŃ]/g,"X"),n=n.replace(/[0-9]/g,"9"),t+n+r})},r=0;r<t.length;r++)e=n(e,t[r]);return e},f=function(e,t){if(e&&e.substr){void 0==t&&(t=0);var n=e.substr(0,t),r=e.substr(t,e.length);return r=r.replace(/[a-zęóąśłżźćń]/g,"x"),r=r.replace(/[A-ZĘÓĄŚŁŻŹĆŃ]/g,"X"),r=r.replace(/[0-9]/g,"9"),n+r}},v=function(){(t.document.hasFocus&&t.document.hasFocus()||"undefined"==typeof t.document.hasFocus)&&(x("Window Focus",null,!1),i=!0,a=!0)},y=function(){var t=e._getMetaSectionAutosaveName(r);if(t){var n=e._prepareUrl(decodeURIComponent(t));x(e.META_SECTION,n,!1)}},S=function(e,t){o.x=e,o.y=t},T=function(){return{x:o.x,y:o.y}},C=function(e){var t,n,r,o={touches:[],targetTouches:[],changedTouches:[]},s=["clientX","clientY","screenX","screenY","pageX","pageY","identifier"];for(t in o)if(o.hasOwnProperty(t)&&e.hasOwnProperty(t))for(n=0;n<e[t].length;n++){for(o[t][n]={},r=0;r<s.length;r++)e[t][n].hasOwnProperty(s[r])&&(o[t][n][s[r]]=e[t][n][s[r]]);o[t][n].checkTag=e[t][n].target.tagName.toLowerCase()}return o},w=function(){var t=e._getWindowSize(),n=e._getDocumentSize(),r=P(),o=T(),s=e._getScroll();A("e",r,o.x+s.x,o.y+s.y,"_uJS","Viewport",t.width,t.height),A("e",r,o.x+s.x,o.y+s.y,"_uJS","Resize",n.width,n.height),A("e",r,o.x+s.x,o.y+s.y,"_uJS","Scale",e._getDocumentScale()),A("e",r,o.x+s.x,o.y+s.y,"_uJS","WrapperOffset",e._wrapFinder.getWrapperOffset())},D={_currentDumpName:"dump",_currentXhr:null,_dumpUrl:"",_emptySendCount:0,_emptySendLimit:1/0,_wasVisitSent:!1,_handleConnection:function(n){var r=n.split("<status>")[1].split("</status>")[0];switch(r){case"ok":if(n.indexOf("token")>-1){var o=n.split("<token>")[1].split("</token>")[0];e._sstorage.set("logDumpToken",o),e._uConsole.log("uRecorder: Recorder connected, token:",o),I("sessionToken",o),t.udashSessionToken=o,h()}else e._uConsole.error("uRecorder: No token recieved"),p();break;case"error project":p();break;case"out of limits":e._sstorage.set("sessionLocked","server capacity exceeded"),p();break;default:p()}},_onSend:function(){},_locationChange:function(){var t=e._sstorage.get("tempDump")||"";t.length>0&&(e._sstorage.set("tempDump",""),e._sstorage.set("dump",t))},_isConnected:function(){var t=e._sstorage.get("logDumpToken");return null!==t&&t.length>=10},_connect:function(){var t=this,n={start:1,project:r.uProjectName,force:r.uForceTracking===!0?1:0};this._currentXhr=e._ajax({url:this._dumpUrl,data:n,success:function(e){t._currentXhr=null,t._handleConnection(e)},error:function(){t._currentXhr=null,e._uConsole.error("uRecorder: Connection to server failed"),p()}})},_disconnect:function(){null!==this._currentXhr&&(this._currentXhr.abort(),this._currentXhr=null)},_setTempMode:function(t){var n;t?this._currentDumpName="tempDump":(this._currentDumpName="dump",n=e._sstorage.get("tempDump")||"",e._sstorage.set("tempDump",""),e._sstorage.set("dump",n))},_getDumpArray:function(){var t=e._sstorage.get(this._currentDumpName);return t?t.split(e._recordsSeparator):[]},_setDumpByArray:function(t){e._sstorage.set(this._currentDumpName,t.join(e._recordsSeparator))},_newRecord:function(e){var t=this._getDumpArray();t.push(e.join("|")),this._setDumpByArray(t),t.length+1>=r.uPackageLimit&&this.send()},_setSendTimeout:function(){var t=this;r.uSendTimeout===!1||isNaN(parseInt(r.uSendTimeout,10))||e._timeouts.set("dumpTimeout",function(){t.send(),t._setSendTimeout()},1e3*parseInt(r.uSendTimeout,10))},_deleteLastRecordIf:function(e){var t=this._getDumpArray();e(t.pop())&&this._setDumpByArray(t)},send:function(){var n,o,s=t.udashSessionToken||e._sstorage.get("logDumpToken")||"",i=this,a=0;if("connected"!==e._status||"dump"!==this._currentDumpName||null!==this._currentXhr)return!1;if(o=0===this._getDumpArray().length){if(this._emptySendCount++,this._emptySendCount>=this._emptySendLimit)return e._uConsole.warn("uRecorder: empty send limit reached, tearing session down"),p()}else this._emptySendCount=0;o&&!this._keepConnection||(this._currentXhr=new XMLHttpRequest,n=this._getDumpArray().join(e._recordsSeparator),this._setTempMode(!0),this._currentXhr=e._ajax({url:this._dumpUrl+"?project="+r.uProjectName+"&token="+s,data:{data:n,append:1,compr:a},error:function(){e._uConsole.error("uRecorder: Error while sending log"),p()},success:function(n){if("ok"===n.split("<status>")[1].split("</status>")[0]){i._wasVisitSent=!0,i._setTempMode(!1),e._timeouts.set("clearDumpXhr",function(){i._currentXhr=null},2e3),"function"==typeof i._onSend&&i._onSend.call(t.uDash,n);var r=n.split("<json>");if(r.length>1){r=JSON.parse(r[1].split("</json>")[0]);var o=r.length;x("Push Received",o);for(var s=0;s<o;s++){var a=r[s].split("|");"a"===a[0]?I(a[1],a[2]):"m"===a[0]&&x(a[1],a[2])}}}else e._uConsole.error("uRecorder: Error while sending log"),p()}}))}},b=function(){e._timeouts.set("sizeUpdate",function(){var t=e._getDocumentSize(),n=T(),r=e._getScroll();s.width===t.width&&s.height===t.height||(A("e",P(),n.x+r.x,n.y+r.y,"_uJS","Resize",t.width,t.height),s=t),b()},500)},E=function(){e._lstorage.set("userID",(new Date).valueOf()+"/"+Math.round(1e9*Math.random())),e._lstorage.set("userVisit",1);var t=new Date,n=t.toString().split(" "),r=n[4].substr(0,5),o=t.getMonth()+1;o<10&&(o="0"+o);var s=n[3]+"-"+o+"-"+n[2]+" "+r;e._lstorage.set("firstVisit",s)},O=function(e){return null!==e&&"undefined"!=typeof e&&e===e},k=function(e,t,n){c[r.uRecordPageChangesAfterEvent]&&A("e",P(),-1,-1,M(t),e,JSON.stringify(n))},R=function(e,t,n,o,s,i){c[e]=1,r.uRecordInteractiveEvents&&A("e",P(t),n,o,M(s),e,JSON.stringify(i))},x=function(n,r,o){if(r&&""!=r&&(!r.replace||(r=r.replace(/\s/g," ").trim(),""!=r))){var s=T(),i=e._getScroll(),a=function(t,n){if(t===e.META_ACTION)x("Time to "+n,Math.round(P()/1e3),!1);else if(t===e.META_SECTION){var r=e._sstorage.get("lastSection")||"";e._sstorage.set("beforeLastSection",r),e._sstorage.set("lastSection",n)}};if("undefined"==typeof o&&(o=!0),!O(n))return void e._uConsole.error("uRecorder: Saving meta event failed, please provide label");o?e._timeouts.set("saveMeta",function(){a(n,r),A("m",P(),s.x+i.x,s.y+i.y,n,r)},0):(a(n,r),A("m",P(),s.x+i.x,s.y+i.y,n,r)),n===e.META_SECTION&&(e._uHeatMapSection=r,t.uHeatMap&&t.uHeatMap.saveMeta(e.META_SECTION,r))}},I=function(t,n){return O(t)&&O(n)?void A("a",t,n):void e._uConsole.error("uRecorder: Saving attribute failed, please provide label and value")},A=function(){var t,n,o=Array.prototype.slice.call(arguments),s=o.shift(),i=[s],a=["a","h","s"];for(r.uTriggersEnabled&&("e"==s||"m"==s?o[5]?_checkAgainstConditions(s,o[3],o[4],o[5]):_checkAgainstConditions(s,o[3],o[4]):"a"==s&&_checkAgainstConditions(s,o[0],o[1])),a.indexOf(s)===-1&&(n=o.shift(),(n>1e8||n<0)&&(n=P()),i=i.concat([n,o.shift(),o.shift()])),t=0;t<o.length;t++)"undefined"!=typeof o[t]&&null!==o[t]&&""!==o[t]||o.splice(t,1);if(i=i.concat(o),r.uDebug&&r.uShowEventsTraceInConsole&&"p"!=s)if("a"===s)"undefined"!=typeof uResponses&&uResponses.helpers.traceEvent&&uResponses.helpers.traceEvent(s,i[1],i[2]),e._uConsole.log("(A):",i[1]+"="+i[2]);else if("m"===s)void 0!=i[5]&&("undefined"!=typeof uResponses&&uResponses.helpers.traceEvent&&uResponses.helpers.traceEvent(s,i[4],i[5]),e._uConsole.log("(M):",i[4]+"="+i[5]));else if("_uJS"!=i[4]){var o=void 0;"change"==i[5]&&i[6]&&(o=i[6]),"undefined"!=typeof uResponses&&uResponses.helpers.traceEvent&&uResponses.helpers.traceEvent(s,i[4],i[5],o),e._uConsole.log("(E):",i[4]+"."+i[5])}"notready"!==e._status&&D._newRecord(i)},N=function(e,t){var n,o,s=e.tagName.toLowerCase(),i=1,a=[];if(("li"===e.tagName.toLowerCase()||t)&&e.parentNode){for(n=e.parentNode.childNodes.length,o=0;o<n&&e!==e.parentNode.childNodes[o];o++)1===e.parentNode.childNodes[o].nodeType&&i++;s+="["+i+"]"}return e.className&&e.className.trim&&(a=e.className.trim().split(/[ \t\n\r]+/),a=a.filter(function(e){if(r.uIgnoreClassNamesWithPrefix)for(var t=0;t<r.uIgnoreClassNamesWithPrefix.length;t++)if(0==e.indexOf(r.uIgnoreClassNamesWithPrefix[t]))return!1;return!0}),a=a.length>0?"."+a.join("."):""),s+(e.getAttribute("id")?"#"+e.getAttribute("id"):"")+a},M=function(e){for(var t,n=[],o=!0;e.tagName&&(t=N(e,o),n.push(t),r.uFullElementBacktrace||!(t.indexOf("#")>-1));)if(e.parentNode){if("HTML"===e.parentNode.tagName)break;e=e.parentNode}return n=n.reverse().join("/")},P=function(t){return t=t||Date.now(),t-parseInt(e._sstorage.get("timeOffset"),10)||0},L=function(){if(r.uRecordCookies&&t.document.cookie){var e=t.document.cookie.split("; "),n="";for(var o in e)if("string"==typeof e[o]){var s=e[o].split("=");(r.uRecordCookies===!0||r.uRecordCookies.indexOf(s)>-1)&&(n+=e[o]+"; ")}A("e",P(),0,0,"_uJS","setCookie",n)}};return __conditions=[],__triggers=[],_triggered={},_outofsample={},_inthesample={},_loadTriggers=function(){e._sstorage.set("triggers","loading");var t="https://"+r.cdnDomain+"/dsdk/"+String(r.uPort).substr(0,2)+"/"+r.uPort;e._sstorage.get("uDebug")?(t+="/triggersDebug.js",e._uConsole.log("uTriggers: Unpublished triggers only.")):t+="/triggers.js";var n=document.createElement("script");n.src=t+"?rnd="+Math.random(),document.head.appendChild(n)},handleTriggers=function(t){e._sstorage.set("triggers",JSON.stringify(t))},_setupTriggers=function(){if("loading"!=e._sstorage.get("triggers")){if(!e._sstorage.get("triggers"))return _loadTriggers(),void e._uConsole.log("uTriggers: Loading triggers...");t.uTriggers=JSON.parse(e._sstorage.get("triggers")),e._uConsole.log("uTriggers: Loading triggers from session storage."),uDash.saveAttribute("triggersVersion",t.uTriggers.hash),__conditions=t.uTriggers.conditions,__triggers=t.uTriggers.triggers;for(var n=0;n<__conditions.length;n++)__conditions[n].key=__conditions[n].key.toLowerCase(),__conditions[n].value=__conditions[n].value.toLowerCase();e._sstorage.get("triggered")&&(_triggered=JSON.parse(e._sstorage.get("triggered"))),_outofsample=e._readCookie("uDashOut"),!_outofsample&&e._lstorage.get("outofsample")&&(_outofsample=e._lstorage.get("outofsample")),_outofsample||(_outofsample="{}");try{_outofsample=JSON.parse(_outofsample)}catch(e){_outofsample={}}_inthesample=e._readCookie("uDashIn"),!_inthesample&&e._lstorage.get("inthesample")&&(_inthesample=e._lstorage.get("inthesample")),_inthesample||(_inthesample="{}");try{_inthesample=JSON.parse(_inthesample)}catch(e){_inthesample={}}var o={},s=function(t){var n=e._sstorage.get(t);if(n){n=n.split("|");for(var r=0;r<n.length;r++)e._uConsole.log("Forcing Trigger ",n[r],"into ",t),o[n[r]]=1,"testIds"===t?(_inthesample[n[r]]=1,delete _outofsample[n[r]]):(_outofsample[n[r]]=1,delete _inthesample[n[r]])}};s("testIds"),s("controlIds");for(var i=0;i<__triggers.length;i++)o[__triggers[i].triggerId]?__triggers[i].minMatches=0:(2===__triggers[i].occurrence?_triggered[__triggers[i].triggerId]&&(__triggers[i].minMatches=-1):3===__triggers[i].occurrence&&_inthesample[__triggers[i].triggerId]&&(__triggers[i].minMatches=-1),1!==__triggers[i].sample&&100!==__triggers[i].sample||(delete _outofsample[__triggers[i].triggerId],_inthesample[__triggers[i].triggerId]=1),o[__triggers[i].triggerId]=1),_outofsample[__triggers[i].triggerId]&&I(__triggers[i].triggerId,"control"),_inthesample[__triggers[i].triggerId]&&I(__triggers[i].triggerId,__triggers[i].filterset+"/"+__triggers[i].response);for(var a in _inthesample)o[a]||delete _inthesample[a];for(var a in _outofsample)o[a]||delete _outofsample[a];e._setCookie("uDashIn",_inthesample),e._setCookie("uDashOut",_outofsample),e._lstorage.set("outofsample",JSON.stringify(_outofsample)),e._lstorage.set("inthesample",JSON.stringify(_inthesample)),r.triggers={in:_inthesample,out:_outofsample}}},_checkAgainstConditions=function(e,t,n,r){if("p"!=e){var o,s,i,a=__conditions.length,u={type:e,key:t,val:n};t&&t.toLowerCase&&(t=t.toLowerCase()),n&&n.toLowerCase&&(n=n.toLowerCase()),r&&(u.params=r);for(var c=0;c<a;c++)if(o=!1,s=!1,e==__conditions[c].type&&n&&(t==__conditions[c].key||t.match(__conditions[c].key))){if(s=!0,i=__conditions[c].sign,"firstVisit"==t){var l=n.split(" ").join("-").split(":").join("-").split("-");n=new Date(l[0],l[1]-1,l[2],l[3],l[4]),l=__conditions[c].value.split(" ").join("-").split(":").join("-").split("-"),__conditions[c].value=new Date(l[0],l[1]-1,l[2],l[3],l[4])}"="==i?n.match?n.match(__conditions[c].value)&&(o=!0):n==__conditions[c].value&&(o=!0):">"==i?n>__conditions[c].value&&(o=!0):">="==i?n>=__conditions[c].value&&(o=!0):"<"==i?n<__conditions[c].value&&(o=!0):"<="==i&&n<=__conditions[c].value&&(o=!0),"a"===__conditions[c].type?1===__conditions[c].inclusion?o?_matchedCondition(c,!0,u):__conditions[c].matched=0:o?__conditions[c].matched=0:_matchedCondition(c,!0,u):"m"===__conditions[c].type&&o&&1===__conditions[c].inclusion&&_matchedCondition(c,!0,u)}else if(!("e"!=e&&"m"!=e||"e"!=__conditions[c].type&&"*"!=__conditions[c].type)){var d=t+"."+n;d.match(__conditions[c].key)&&(o=_matchedCondition(c,!0,u))}}},_matchedCondition=function(e,t,n){var r=__conditions[e],o=__triggers[r.triggerId],s=0;if(__conditions[e].matched=1,o.minMatches!==-1){var i,a,u=!0;if(s=o.conditions.length,s>1)for(e=0;e<s;e++)if(r=__conditions[o.conditions[e]],1!==r.matched){if(u=!1,r.ORs)for(i=r.ORs.length,a=0;e<i;e++)if(1===__conditions[r.ORs[a]].matched){u=!0;break}if(!u)break}u&&(1==o.occurrence||(o.minMatches=-1),n&&_executeTrigger(o,n))}return _saveTriggers(),!0},_setMatchedCondition=function(e,t){setTimeout(function(){__conditions[e].matched=t},5)},_saveTriggers=function(){clearTimeout(t.saveTriggersId),t.saveTriggersId=setTimeout(function(){e._sstorage.set("triggers",JSON.stringify(t.uTriggers))},100)},_executeTrigger=function(n,o){if("undefined"==typeof uResponses){for(var s=document.getElementsByTagName("script"),i=!1,a=s.length;a--;)if(s[a].src.indexOf("uResponses")>0){i=!0;break}if(!i){var u=document.createElement("script");u.type="text/javascript",u.src="https://"+r.cdnDomain+"/sdk/"+r.uPort+"/uResponses.min.js",t.document.getElementsByTagName("head")[0].appendChild(u)}return void setTimeout(function(){_executeTrigger(n,o)}.bind(this),100)}if(_triggered[n.triggerId]=1,e._sstorage.set("triggered",JSON.stringify(_triggered)),x("Triggered",n.filterset+"/"+n.response+"/"+n.triggerId),n.sample<1&&!_inthesample[n.triggerId]&&!_outofsample[n.triggerId]&&(Math.random()>n.sample?(I(n.triggerId,"control"),_outofsample[n.triggerId]=1,e._setCookie("uDashOut",_outofsample),e._lstorage.set("outofsample",JSON.stringify(_outofsample))):(I(n.triggerId,n.filterset+"/"+n.response),_inthesample[n.triggerId]=1,e._setCookie("uDashIn",_inthesample),e._lstorage.set("inthesample",JSON.stringify(_inthesample)))),1===n.sample||100===n.sample||_inthesample[n.triggerId]){"string"==typeof n.version&&0===n.version.indexOf("{")&&(n.version=JSON.parse(n.version)),"string"==typeof n.options&&(n.options=JSON.parse(n.options));try{n.version&&(n.version.triggeringEvent=o,e._uConsole.log("In The Sample: Triggered",n.filterset+"/"+n.response+"/"+n.triggerId,"Triggered by:",n.version.triggeringEvent),t.uResponses.execute(n.response,n.version,function(t){t&&(window.e=t,e._uConsole.error("UIB Response",n.triggerId,"Triggered by:",n.version.triggeringEvent,"Status:",t),t&&"Error"==t.name&&x("Error",n.triggerId+" "+t.toString()))},n.options))}catch(e){x("Error",n.triggerId+" exec error: "+JSON.stringify(e))}}else e._uConsole.log("Out Of The Sample: Triggered",n.filterset+"/"+n.response+"/"+n.triggerId),e._uConsole.log("uTrigger:",n.triggerId,"Not in the sample")},{META_ACTION:e.META_ACTION,META_SECTION:e.META_SECTION,META_ERROR:e.META_ERROR,META_SITE_IS_READY:e.META_SITE_IS_READY,init:d,getSetting:function(e){return r[e]||""},getStatus:e._bindShim(e.getStatus,e),tearDown:p,saveAttribute:I,saveMeta:x,sendDump:e._bindShim(D.send,D),handleTriggers:handleTriggers}}(window);return t}.apply(t,r),!(void 0!==o&&(e.exports=o))}]);
//# sourceMappingURL=udash.min.js.map